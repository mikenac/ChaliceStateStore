
# AWS Chalice User State Store
  
  
### Description:  
Simple example of using AWS Chalice to create a simple object state store with Kinesis, Lambda, and DynamoDB. Messages are produced to Kinesis, which are then consumed by Lambda, and persisted in DynamoDB.
 
 ### Requirements

 1. Python 3
 2. Linux/Mac
 3. Terraform 12+
 4. AWS credentials

### Installation:  
```
python3 -m venv .venv
source .venv/bin/activate
pip install -r requirements.txt
``` 
  
## Usage:  

### Note:
This assumes that your AWS credentials are correctly configured with access from the CLI, and if your credentials do not have permission to perform Admin type operations that you have a role assumption properly configured in your AWS config, with the profile properly exported to the shell.
 
 Basically, these should all be correct:
 
|Environment Variable| Description |
|--|--|
|AWS_SECRET_ACCESS_KEY  | Secret Key |
|AWS_ACCESS_KEY_ID | Access Key |
|AWS_PROFILE | If you need to assume a role, the profile in your ~/.aws.config file that describes the role assumption |
| AWS_DEFAULT_REGION | Region for setup | 

See: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-quickstart.html

#### Initial Deploy  
This will deploy both infrastructure and code
``` ./deploy_all.sh ```

#### Deploy Code
Packages the code and deploys
``` /deploy.sh ```
  
#### Destroy:  
  Destroys all infrastructure
```./destroy_all.sh ```  

#### Produce Messages:
```python kinesis_producer.py ```

#### Dump Messages to Console:
```python dynamo_dumper.py```

 ## Structure

|Item	|Description  |
|--|--|
| app.py | Main application file |
| .chalice/config.json | Configuration values |
| /infra | Contains the Terraform code to provision Kinesis and Dynamo |
| /deploy | Contains the deployment code generated by Chalice |


